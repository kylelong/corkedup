{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar object_sizeof_1 = __importDefault(require(\"object-sizeof\"));\n\nvar utils_1 = require(\"./utils\");\n\nvar windowSessionStorage = typeof sessionStorage !== 'undefined' ? sessionStorage : undefined;\n\nvar Cache =\n/** @class */\nfunction () {\n  function Cache(ttl, maxByteSize) {\n    if (ttl === void 0) {\n      ttl = 360;\n    }\n\n    if (maxByteSize === void 0) {\n      maxByteSize = 16000000;\n    }\n\n    this.cache = new Map();\n    this.ttl = ttl;\n    this.maxByteSize = maxByteSize;\n  }\n\n  Cache.prototype.add = function (query, data) {\n    var hashedKey = utils_1.generateHash(query);\n    var added = new Date();\n    var entry = {\n      added: added,\n      data: data\n    };\n    this.cache.set(hashedKey, entry);\n    windowSessionStorage === null || windowSessionStorage === void 0 ? void 0 : windowSessionStorage.setItem(hashedKey, JSON.stringify(entry));\n    this.clearSpace();\n  };\n\n  Cache.prototype.get = function (query) {\n    var hashedKey = utils_1.generateHash(query);\n\n    if (!this.has(query)) {\n      return null;\n    }\n\n    try {\n      var entry = this.cache.get(hashedKey);\n\n      if (!entry) {\n        var sessionData = windowSessionStorage === null || windowSessionStorage === void 0 ? void 0 : windowSessionStorage.getItem(hashedKey);\n\n        if (!sessionData) {\n          return;\n        }\n\n        return JSON.parse(sessionData);\n      }\n\n      return entry.data;\n    } catch (error) {\n      return null;\n    }\n  };\n\n  Cache.prototype.has = function (query) {\n    var hashedKey = utils_1.generateHash(query);\n\n    try {\n      var now = new Date();\n      var data = this.cache.get(hashedKey);\n\n      if (!data) {\n        var sessionData = windowSessionStorage === null || windowSessionStorage === void 0 ? void 0 : windowSessionStorage.getItem(hashedKey);\n\n        if (!sessionData) {\n          return false;\n        }\n\n        data = JSON.parse(sessionData);\n      }\n\n      var entryAdded = new Date(data.added);\n\n      if (now.getTime() > entryAdded.getTime() + this.ttl * 1000) {\n        windowSessionStorage === null || windowSessionStorage === void 0 ? void 0 : windowSessionStorage.removeItem(hashedKey);\n        this.cache.delete(hashedKey);\n        return false;\n      }\n\n      return true;\n    } catch (error) {\n      return false;\n    }\n  };\n\n  Cache.prototype.clearSpace = function () {\n    var cacheArray = Array.from(this.cache);\n\n    if (object_sizeof_1.default(cacheArray) < this.maxByteSize) {\n      return;\n    }\n\n    cacheArray.sort(function (a, b) {\n      return a[1].added.getTime() - b[1].added.getTime();\n    });\n    var reducedCacheArray = cacheArray.slice(1);\n    this.cache = new Map(reducedCacheArray);\n    this.clearSpace();\n  };\n\n  return Cache;\n}();\n\nexports.default = Cache;","map":{"version":3,"sources":["/Users/kylelong/corkedup/node_modules/twitter-api-client/dist/base/Cache.js"],"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","object_sizeof_1","require","utils_1","windowSessionStorage","sessionStorage","undefined","Cache","ttl","maxByteSize","cache","Map","prototype","add","query","data","hashedKey","generateHash","added","Date","entry","set","setItem","JSON","stringify","clearSpace","get","has","sessionData","getItem","parse","error","now","entryAdded","getTime","removeItem","delete","cacheArray","Array","from","default","sort","a","b","reducedCacheArray","slice"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar object_sizeof_1 = __importDefault(require(\"object-sizeof\"));\nvar utils_1 = require(\"./utils\");\nvar windowSessionStorage = typeof sessionStorage !== 'undefined' ? sessionStorage : undefined;\nvar Cache = /** @class */ (function () {\n    function Cache(ttl, maxByteSize) {\n        if (ttl === void 0) { ttl = 360; }\n        if (maxByteSize === void 0) { maxByteSize = 16000000; }\n        this.cache = new Map();\n        this.ttl = ttl;\n        this.maxByteSize = maxByteSize;\n    }\n    Cache.prototype.add = function (query, data) {\n        var hashedKey = utils_1.generateHash(query);\n        var added = new Date();\n        var entry = {\n            added: added,\n            data: data,\n        };\n        this.cache.set(hashedKey, entry);\n        windowSessionStorage === null || windowSessionStorage === void 0 ? void 0 : windowSessionStorage.setItem(hashedKey, JSON.stringify(entry));\n        this.clearSpace();\n    };\n    Cache.prototype.get = function (query) {\n        var hashedKey = utils_1.generateHash(query);\n        if (!this.has(query)) {\n            return null;\n        }\n        try {\n            var entry = this.cache.get(hashedKey);\n            if (!entry) {\n                var sessionData = windowSessionStorage === null || windowSessionStorage === void 0 ? void 0 : windowSessionStorage.getItem(hashedKey);\n                if (!sessionData) {\n                    return;\n                }\n                return JSON.parse(sessionData);\n            }\n            return entry.data;\n        }\n        catch (error) {\n            return null;\n        }\n    };\n    Cache.prototype.has = function (query) {\n        var hashedKey = utils_1.generateHash(query);\n        try {\n            var now = new Date();\n            var data = this.cache.get(hashedKey);\n            if (!data) {\n                var sessionData = windowSessionStorage === null || windowSessionStorage === void 0 ? void 0 : windowSessionStorage.getItem(hashedKey);\n                if (!sessionData) {\n                    return false;\n                }\n                data = JSON.parse(sessionData);\n            }\n            var entryAdded = new Date(data.added);\n            if (now.getTime() > entryAdded.getTime() + this.ttl * 1000) {\n                windowSessionStorage === null || windowSessionStorage === void 0 ? void 0 : windowSessionStorage.removeItem(hashedKey);\n                this.cache.delete(hashedKey);\n                return false;\n            }\n            return true;\n        }\n        catch (error) {\n            return false;\n        }\n    };\n    Cache.prototype.clearSpace = function () {\n        var cacheArray = Array.from(this.cache);\n        if (object_sizeof_1.default(cacheArray) < this.maxByteSize) {\n            return;\n        }\n        cacheArray.sort(function (a, b) { return a[1].added.getTime() - b[1].added.getTime(); });\n        var reducedCacheArray = cacheArray.slice(1);\n        this.cache = new Map(reducedCacheArray);\n        this.clearSpace();\n    };\n    return Cache;\n}());\nexports.default = Cache;\n"]},"metadata":{},"sourceType":"script"}